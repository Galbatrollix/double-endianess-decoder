# Double Endianess Decoder
This header file provides utility functions for endianess-agnostic handling of IEEE-754 conformant double precision floating point numbers. All possible byte-endianess types are supported, not just little/big endian.
For example if on your machine the double byte order is the following: ```AGHC BFDE```, then functions generated by this header should be able to correctly interpret it.
## Available functions
This header defines the following functions:
```c
// converts double from big endian to little endian representation and vice versa
double dbl_bytes_reverse(double);

// converts double representation from whatever is the system's into little/big endian respectively
double dbl_system_to_LE(double);
double dbl_system_to_BE(double);

// converts double in little/big endian representation to whatever is the system's representation
double dbl_LE_to_system(double);
double dbl_BE_to_system(double);

```
### For example:
If system's byte order for double type is ``` [ B A D C G F E H ] ``` where A is the most significant byte:
Then result of the call to ```dbl_system_to_LE( X ); ``` would have the following byte ordering :
``` [ H G F E D C B A ] ```. 

Result of calling ```dbl_BE_to_system( Y )``` will be the system's byte order of  ``` [ B A D C G F E H ] ```, as long as provided Y has the big endian byte order, which is:
```[ A B C D E F G H ]```

Therefore, the following expressions should always be true:
```c
double X = ... ;
X == dbl_LE_to_system(dbl_system_to_LE(X));
X == dbl_BE_to_system(dbl_system_to_BE(X));
X == dbl_LE_to_system(reverse_bytes(dbl_system_to_BE(X)));
X == dbl_BE_to_system(reverse_bytes(dbl_system_to_LE(X)));
```

All the above functions are thread and strict-aliasing safe and utilize either unsigned char * accesses or integer bitwise operations to perform all the conversions. Despite the fact that the generic function definiotions can handle conversions on their own, the header file performs some define macro checks for predefined compiler constants in order to help some compilers (especially GCC) produce better code. Because of the macros, the header file also includes ```<limits.h>``` and ```<stdint.h>``` and potentially ```<endian.h>``` if code is compiled under GCC version that supports it and ```__has_include``` macro. Aside from that, the header doesn't pollute user's namespace as it undefines all temporary macros near the end of the file. 

### Potential use case:
Let's say you need to load a binary file of doubles, do some computations and write them to the file, but no matter the system the files are required to contain Big Endian representation. The task can be performed regardles of platform's endianess in the following way, using this header: 
```c
// #include "double_endianess_decoder.h"

double buffer[20];
double result_buffer[10];

// LOAD CONTENT OF BINARY FILE INTO "buffer" 

// convert from file's (Big endian) representations to system's
for(int i=0; i<20 ; i++){
    buffer[i] = dbl_BE_to_system(buffer[i]);
}
// DO SOME COMPUTATION HERE

// convert from system's representation to file's (Big endian)
for(int i=0; i<10 ; i++){
    result_buffer[i] = dbl_system_to_BE(result_buffer[i]);
}

// SAVE CONTENT OF "result_buffer" INTO FILE 
```

## Few words from the creator
This project originated as a self-imposed challenge and an exercise in C preprocessor macros, however as it may be of use for someone I decided to publish it. 
It's been tested extensively with godbolt compiler explorer, however I cannot provide a guarantee that the library works on all IEEE-754 conforming systems and all possible compilers. 
It is also worth noting that despite my efforts to make the header generate well optimized code on all platforms, currently the MSVC compiler is unable to recognize what it does and according to
godbolt compiler explorer generates rather inefficient (although correct) code. 

If you are interested at how various compilers and platforms compile code with this header, you can check compiler explorer's outputs. Link to godbolt with this header included: [here](https://godbolt.org/z/dKjoE8753)
